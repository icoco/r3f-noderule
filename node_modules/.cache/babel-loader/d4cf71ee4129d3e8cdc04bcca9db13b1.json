{"ast":null,"code":"var Rule = function Rule(name, fn, args, modifiers) {\n  this.name = name;\n  this.fn = fn;\n  this.args = args;\n  this.modifiers = modifiers;\n};\n\nRule.prototype._test = function _test(value) {\n  var fn = this.fn;\n\n  try {\n    testAux(this.modifiers.slice(), fn, this)(value);\n  } catch (ex) {\n    fn = function () {\n      return false;\n    };\n  }\n\n  try {\n    return testAux(this.modifiers.slice(), fn, this)(value);\n  } catch (ex$1) {\n    return false;\n  }\n};\n\nRule.prototype._check = function _check(value) {\n  try {\n    testAux(this.modifiers.slice(), this.fn, this)(value);\n  } catch (ex) {\n    if (testAux(this.modifiers.slice(), function (it) {\n      return it;\n    }, this)(false)) {\n      return;\n    }\n  }\n\n  if (!testAux(this.modifiers.slice(), this.fn, this)(value)) {\n    throw null;\n  }\n};\n\nRule.prototype._testAsync = function _testAsync(value) {\n  var this$1 = this;\n  return new Promise(function (resolve, reject) {\n    testAsyncAux(this$1.modifiers.slice(), this$1.fn, this$1)(value).then(function (valid) {\n      if (valid) {\n        resolve(value);\n      } else {\n        reject(null);\n      }\n    }).catch(function (ex) {\n      return reject(ex);\n    });\n  });\n};\n\nfunction pickFn(fn, variant) {\n  if (variant === void 0) variant = 'simple';\n  return typeof fn === 'object' ? fn[variant] : fn;\n}\n\nfunction testAux(modifiers, fn, rule) {\n  if (modifiers.length) {\n    var modifier = modifiers.shift();\n    var nextFn = testAux(modifiers, fn, rule);\n    return modifier.perform(nextFn, rule);\n  } else {\n    return pickFn(fn);\n  }\n}\n\nfunction testAsyncAux(modifiers, fn, rule) {\n  if (modifiers.length) {\n    var modifier = modifiers.shift();\n    var nextFn = testAsyncAux(modifiers, fn, rule);\n    return modifier.performAsync(nextFn, rule);\n  } else {\n    return function (value) {\n      return Promise.resolve(pickFn(fn, 'async')(value));\n    };\n  }\n}\n\nvar Modifier = function Modifier(name, perform, performAsync) {\n  this.name = name;\n  this.perform = perform;\n  this.performAsync = performAsync;\n};\n\nvar ValidationError = /*@__PURE__*/function (Error) {\n  function ValidationError(rule, value, cause, target) {\n    var remaining = [],\n        len = arguments.length - 4;\n\n    while (len-- > 0) remaining[len] = arguments[len + 4];\n\n    Error.call(this, remaining);\n\n    if (Error.captureStackTrace) {\n      Error.captureStackTrace(this, ValidationError);\n    }\n\n    this.rule = rule;\n    this.value = value;\n    this.cause = cause;\n    this.target = target;\n  }\n\n  if (Error) ValidationError.__proto__ = Error;\n  ValidationError.prototype = Object.create(Error && Error.prototype);\n  ValidationError.prototype.constructor = ValidationError;\n  return ValidationError;\n}(Error);\n\nvar Context = function Context(chain, nextRuleModifiers) {\n  if (chain === void 0) chain = [];\n  if (nextRuleModifiers === void 0) nextRuleModifiers = [];\n  this.chain = chain;\n  this.nextRuleModifiers = nextRuleModifiers;\n};\n\nContext.prototype._applyRule = function _applyRule(ruleFn, name) {\n  var this$1 = this;\n  return function () {\n    var args = [],\n        len = arguments.length;\n\n    while (len--) args[len] = arguments[len];\n\n    this$1.chain.push(new Rule(name, ruleFn.apply(this$1, args), args, this$1.nextRuleModifiers));\n    this$1.nextRuleModifiers = [];\n    return this$1;\n  };\n};\n\nContext.prototype._applyModifier = function _applyModifier(modifier, name) {\n  this.nextRuleModifiers.push(new Modifier(name, modifier.simple, modifier.async));\n  return this;\n};\n\nContext.prototype._clone = function _clone() {\n  return new Context(this.chain.slice(), this.nextRuleModifiers.slice());\n};\n\nContext.prototype.test = function test(value) {\n  return this.chain.every(function (rule) {\n    return rule._test(value);\n  });\n};\n\nContext.prototype.testAll = function testAll(value) {\n  var err = [];\n  this.chain.forEach(function (rule) {\n    try {\n      rule._check(value);\n    } catch (ex) {\n      err.push(new ValidationError(rule, value, ex));\n    }\n  });\n  return err;\n};\n\nContext.prototype.check = function check(value) {\n  this.chain.forEach(function (rule) {\n    try {\n      rule._check(value);\n    } catch (ex) {\n      throw new ValidationError(rule, value, ex);\n    }\n  });\n};\n\nContext.prototype.testAsync = function testAsync(value) {\n  var this$1 = this;\n  return new Promise(function (resolve, reject) {\n    executeAsyncRules(value, this$1.chain.slice(), resolve, reject);\n  });\n};\n\nfunction executeAsyncRules(value, rules, resolve, reject) {\n  if (rules.length) {\n    var rule = rules.shift();\n\n    rule._testAsync(value).then(function () {\n      executeAsyncRules(value, rules, resolve, reject);\n    }, function (cause) {\n      reject(new ValidationError(rule, value, cause));\n    });\n  } else {\n    resolve(value);\n  }\n}\n\nvar consideredEmpty = function (value, considerTrimmedEmptyString) {\n  if (considerTrimmedEmptyString && typeof value === 'string' && value.trim().length === 0) {\n    return true;\n  }\n\n  return value === undefined || value === null;\n};\n\nfunction optional(validation, considerTrimmedEmptyString) {\n  if (considerTrimmedEmptyString === void 0) considerTrimmedEmptyString = false;\n  return {\n    simple: function (value) {\n      return consideredEmpty(value, considerTrimmedEmptyString) || validation.check(value) === undefined;\n    },\n    async: function (value) {\n      return consideredEmpty(value, considerTrimmedEmptyString) || validation.testAsync(value);\n    }\n  };\n}\n\nfunction v8n() {\n  return typeof Proxy !== 'undefined' ? proxyContext(new Context()) : proxylessContext(new Context());\n} // Custom rules\n\n\nvar customRules = {};\n\nv8n.extend = function (newRules) {\n  Object.assign(customRules, newRules);\n};\n\nv8n.clearCustomRules = function () {\n  customRules = {};\n};\n\nfunction proxyContext(context) {\n  return new Proxy(context, {\n    get: function get(obj, prop) {\n      if (prop in obj) {\n        return obj[prop];\n      }\n\n      var newContext = proxyContext(context._clone());\n\n      if (prop in availableModifiers) {\n        return newContext._applyModifier(availableModifiers[prop], prop);\n      }\n\n      if (prop in customRules) {\n        return newContext._applyRule(customRules[prop], prop);\n      }\n\n      if (prop in availableRules) {\n        return newContext._applyRule(availableRules[prop], prop);\n      }\n    }\n  });\n}\n\nfunction proxylessContext(context) {\n  var addRuleSet = function (ruleSet, targetContext) {\n    Object.keys(ruleSet).forEach(function (prop) {\n      targetContext[prop] = function () {\n        var args = [],\n            len = arguments.length;\n\n        while (len--) args[len] = arguments[len];\n\n        var newContext = proxylessContext(targetContext._clone());\n\n        var contextWithRuleApplied = newContext._applyRule(ruleSet[prop], prop).apply(void 0, args);\n\n        return contextWithRuleApplied;\n      };\n    });\n    return targetContext;\n  };\n\n  var contextWithAvailableRules = addRuleSet(availableRules, context);\n  var contextWithAllRules = addRuleSet(customRules, contextWithAvailableRules);\n  Object.keys(availableModifiers).forEach(function (prop) {\n    Object.defineProperty(contextWithAllRules, prop, {\n      get: function () {\n        var newContext = proxylessContext(contextWithAllRules._clone());\n        return newContext._applyModifier(availableModifiers[prop], prop);\n      }\n    });\n  });\n  return contextWithAllRules;\n}\n\nvar availableModifiers = {\n  not: {\n    simple: function (fn) {\n      return function (value) {\n        return !fn(value);\n      };\n    },\n    async: function (fn) {\n      return function (value) {\n        return Promise.resolve(fn(value)).then(function (result) {\n          return !result;\n        }).catch(function () {\n          return true;\n        });\n      };\n    }\n  },\n  some: {\n    simple: function (fn) {\n      return function (value) {\n        return split(value).some(function (item) {\n          try {\n            return fn(item);\n          } catch (ex) {\n            return false;\n          }\n        });\n      };\n    },\n    async: function (fn) {\n      return function (value) {\n        return Promise.all(split(value).map(function (item) {\n          try {\n            return fn(item).catch(function () {\n              return false;\n            });\n          } catch (ex) {\n            return false;\n          }\n        })).then(function (result) {\n          return result.some(Boolean);\n        });\n      };\n    }\n  },\n  every: {\n    simple: function (fn) {\n      return function (value) {\n        return value !== false && split(value).every(fn);\n      };\n    },\n    async: function (fn) {\n      return function (value) {\n        return Promise.all(split(value).map(fn)).then(function (result) {\n          return result.every(Boolean);\n        });\n      };\n    }\n  },\n  strict: {\n    simple: function (fn, rule) {\n      return function (value) {\n        if (isSchemaRule(rule) && value && typeof value === 'object') {\n          return Object.keys(rule.args[0]).length === Object.keys(value).length && fn(value);\n        }\n\n        return fn(value);\n      };\n    },\n    async: function (fn, rule) {\n      return function (value) {\n        return Promise.resolve(fn(value)).then(function (result) {\n          if (isSchemaRule(rule) && value && typeof value === 'object') {\n            return Object.keys(rule.args[0]).length === Object.keys(value).length && result;\n          }\n\n          return result;\n        }).catch(function () {\n          return false;\n        });\n      };\n    }\n  }\n};\n\nfunction isSchemaRule(rule) {\n  return rule && rule.name === 'schema' && rule.args.length > 0 && typeof rule.args[0] === 'object';\n}\n\nfunction split(value) {\n  if (typeof value === 'string') {\n    return value.split('');\n  }\n\n  return value;\n}\n\nvar availableRules = {\n  // Value\n  equal: function (expected) {\n    return function (value) {\n      return value == expected;\n    };\n  },\n  exact: function (expected) {\n    return function (value) {\n      return value === expected;\n    };\n  },\n  // Types\n  number: function (allowInfinite) {\n    if (allowInfinite === void 0) allowInfinite = true;\n    return function (value) {\n      return typeof value === 'number' && (allowInfinite || isFinite(value));\n    };\n  },\n  integer: function () {\n    return function (value) {\n      var isInteger = Number.isInteger || isIntegerPolyfill;\n      return isInteger(value);\n    };\n  },\n  numeric: function () {\n    return function (value) {\n      return !isNaN(parseFloat(value)) && isFinite(value);\n    };\n  },\n  string: function () {\n    return testType('string');\n  },\n  boolean: function () {\n    return testType('boolean');\n  },\n  undefined: function () {\n    return testType('undefined');\n  },\n  null: function () {\n    return testType('null');\n  },\n  array: function () {\n    return testType('array');\n  },\n  object: function () {\n    return testType('object');\n  },\n  instanceOf: function (instance) {\n    return function (value) {\n      return value instanceof instance;\n    };\n  },\n  // Pattern\n  pattern: function (expected) {\n    return function (value) {\n      return expected.test(value);\n    };\n  },\n  lowercase: function () {\n    return function (value) {\n      return typeof value === 'boolean' || value === value.toLowerCase() && value.trim() !== '';\n    };\n  },\n  uppercase: function () {\n    return function (value) {\n      return value === value.toUpperCase() && value.trim() !== '';\n    };\n  },\n  vowel: function () {\n    return function (value) {\n      return /^[aeiou]+$/i.test(value);\n    };\n  },\n  consonant: function () {\n    return function (value) {\n      return /^(?=[^aeiou])([a-z]+)$/i.test(value);\n    };\n  },\n  // Value at\n  first: function (expected) {\n    return function (value) {\n      return value[0] == expected;\n    };\n  },\n  last: function (expected) {\n    return function (value) {\n      return value[value.length - 1] == expected;\n    };\n  },\n  // Length\n  empty: function () {\n    return function (value) {\n      return value.length === 0;\n    };\n  },\n  length: function (min, max) {\n    return function (value) {\n      return value.length >= min && value.length <= (max || min);\n    };\n  },\n  minLength: function (min) {\n    return function (value) {\n      return value.length >= min;\n    };\n  },\n  maxLength: function (max) {\n    return function (value) {\n      return value.length <= max;\n    };\n  },\n  // Range\n  negative: function () {\n    return function (value) {\n      return value < 0;\n    };\n  },\n  positive: function () {\n    return function (value) {\n      return value >= 0;\n    };\n  },\n  between: function (a, b) {\n    return function (value) {\n      return value >= a && value <= b;\n    };\n  },\n  range: function (a, b) {\n    return function (value) {\n      return value >= a && value <= b;\n    };\n  },\n  lessThan: function (n) {\n    return function (value) {\n      return value < n;\n    };\n  },\n  lessThanOrEqual: function (n) {\n    return function (value) {\n      return value <= n;\n    };\n  },\n  greaterThan: function (n) {\n    return function (value) {\n      return value > n;\n    };\n  },\n  greaterThanOrEqual: function (n) {\n    return function (value) {\n      return value >= n;\n    };\n  },\n  // Divisible\n  even: function () {\n    return function (value) {\n      return value % 2 === 0;\n    };\n  },\n  odd: function () {\n    return function (value) {\n      return value % 2 !== 0;\n    };\n  },\n  includes: function (expected) {\n    return function (value) {\n      return ~value.indexOf(expected);\n    };\n  },\n  schema: function (schema) {\n    return testSchema(schema);\n  },\n  // branching\n  passesAnyOf: function () {\n    var validations = [],\n        len = arguments.length;\n\n    while (len--) validations[len] = arguments[len];\n\n    return function (value) {\n      return validations.some(function (validation) {\n        return validation.test(value);\n      });\n    };\n  },\n  optional: optional\n};\n\nfunction testType(expected) {\n  return function (value) {\n    return Array.isArray(value) && expected === 'array' || value === null && expected === 'null' || typeof value === expected;\n  };\n}\n\nfunction isIntegerPolyfill(value) {\n  return typeof value === 'number' && isFinite(value) && Math.floor(value) === value;\n}\n\nfunction testSchema(schema) {\n  return {\n    simple: function (value) {\n      var causes = [];\n      Object.keys(schema).forEach(function (key) {\n        var nestedValidation = schema[key];\n\n        try {\n          nestedValidation.check((value || {})[key]);\n        } catch (ex) {\n          ex.target = key;\n          causes.push(ex);\n        }\n      });\n\n      if (causes.length > 0) {\n        throw causes;\n      }\n\n      return true;\n    },\n    async: function (value) {\n      var causes = [];\n      var nested = Object.keys(schema).map(function (key) {\n        var nestedValidation = schema[key];\n        return nestedValidation.testAsync((value || {})[key]).catch(function (ex) {\n          ex.target = key;\n          causes.push(ex);\n        });\n      });\n      return Promise.all(nested).then(function () {\n        if (causes.length > 0) {\n          throw causes;\n        }\n\n        return true;\n      });\n    }\n  };\n}\n\nexport default v8n;","map":{"version":3,"sources":["/Users/icoco/Workspace/2022/prj/webgl/r3f-app/node_modules/v8n/dist/v8n.esm.js"],"names":["Rule","name","fn","args","modifiers","prototype","_test","value","testAux","slice","ex","ex$1","_check","it","_testAsync","this$1","Promise","resolve","reject","testAsyncAux","then","valid","catch","pickFn","variant","rule","length","modifier","shift","nextFn","perform","performAsync","Modifier","ValidationError","Error","cause","target","remaining","len","arguments","call","captureStackTrace","__proto__","Object","create","constructor","Context","chain","nextRuleModifiers","_applyRule","ruleFn","push","apply","_applyModifier","simple","async","_clone","test","every","testAll","err","forEach","check","testAsync","executeAsyncRules","rules","consideredEmpty","considerTrimmedEmptyString","trim","undefined","optional","validation","v8n","Proxy","proxyContext","proxylessContext","customRules","extend","newRules","assign","clearCustomRules","context","get","obj","prop","newContext","availableModifiers","availableRules","addRuleSet","ruleSet","targetContext","keys","contextWithRuleApplied","contextWithAvailableRules","contextWithAllRules","defineProperty","not","result","some","split","item","all","map","Boolean","strict","isSchemaRule","equal","expected","exact","number","allowInfinite","isFinite","integer","isInteger","Number","isIntegerPolyfill","numeric","isNaN","parseFloat","string","testType","boolean","null","array","object","instanceOf","instance","pattern","lowercase","toLowerCase","uppercase","toUpperCase","vowel","consonant","first","last","empty","min","max","minLength","maxLength","negative","positive","between","a","b","range","lessThan","n","lessThanOrEqual","greaterThan","greaterThanOrEqual","even","odd","includes","indexOf","schema","testSchema","passesAnyOf","validations","Array","isArray","Math","floor","causes","key","nestedValidation","nested"],"mappings":"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","sourcesContent":["var Rule = function Rule(name, fn, args, modifiers) {\n  this.name = name;\n  this.fn = fn;\n  this.args = args;\n  this.modifiers = modifiers;\n};\n\nRule.prototype._test = function _test (value) {\n  var fn = this.fn;\n\n  try {\n    testAux(this.modifiers.slice(), fn, this)(value);\n  } catch (ex) {\n    fn = function () { return false; };\n  }\n\n  try {\n    return testAux(this.modifiers.slice(), fn, this)(value);\n  } catch (ex$1) {\n    return false;\n  }\n};\n\nRule.prototype._check = function _check (value) {\n  try {\n    testAux(this.modifiers.slice(), this.fn, this)(value);\n  } catch (ex) {\n    if (testAux(this.modifiers.slice(), function (it) { return it; }, this)(false)) {\n      return;\n    }\n  }\n\n  if (!testAux(this.modifiers.slice(), this.fn, this)(value)) {\n    throw null;\n  }\n};\n\nRule.prototype._testAsync = function _testAsync (value) {\n    var this$1 = this;\n\n  return new Promise(function (resolve, reject) {\n    testAsyncAux(\n      this$1.modifiers.slice(),\n      this$1.fn,\n      this$1\n    )(value)\n      .then(function (valid) {\n        if (valid) {\n          resolve(value);\n        } else {\n          reject(null);\n        }\n      })\n      .catch(function (ex) { return reject(ex); });\n  });\n};\n\nfunction pickFn(fn, variant) {\n  if ( variant === void 0 ) variant = 'simple';\n\n  return typeof fn === 'object' ? fn[variant] : fn;\n}\n\nfunction testAux(modifiers, fn, rule) {\n  if (modifiers.length) {\n    var modifier = modifiers.shift();\n    var nextFn = testAux(modifiers, fn, rule);\n    return modifier.perform(nextFn, rule);\n  } else {\n    return pickFn(fn);\n  }\n}\n\nfunction testAsyncAux(modifiers, fn, rule) {\n  if (modifiers.length) {\n    var modifier = modifiers.shift();\n    var nextFn = testAsyncAux(modifiers, fn, rule);\n    return modifier.performAsync(nextFn, rule);\n  } else {\n    return function (value) { return Promise.resolve(pickFn(fn, 'async')(value)); };\n  }\n}\n\nvar Modifier = function Modifier(name, perform, performAsync) {\n  this.name = name;\n  this.perform = perform;\n  this.performAsync = performAsync;\n};\n\nvar ValidationError = /*@__PURE__*/(function (Error) {\n  function ValidationError(rule, value, cause, target) {\n    var remaining = [], len = arguments.length - 4;\n    while ( len-- > 0 ) remaining[ len ] = arguments[ len + 4 ];\n\n    Error.call(this, remaining);\n    if (Error.captureStackTrace) {\n      Error.captureStackTrace(this, ValidationError);\n    }\n    this.rule = rule;\n    this.value = value;\n    this.cause = cause;\n    this.target = target;\n  }\n\n  if ( Error ) ValidationError.__proto__ = Error;\n  ValidationError.prototype = Object.create( Error && Error.prototype );\n  ValidationError.prototype.constructor = ValidationError;\n\n  return ValidationError;\n}(Error));\n\nvar Context = function Context(chain, nextRuleModifiers) {\n  if ( chain === void 0 ) chain = [];\n  if ( nextRuleModifiers === void 0 ) nextRuleModifiers = [];\n\n  this.chain = chain;\n  this.nextRuleModifiers = nextRuleModifiers;\n};\n\nContext.prototype._applyRule = function _applyRule (ruleFn, name) {\n    var this$1 = this;\n\n  return function () {\n      var args = [], len = arguments.length;\n      while ( len-- ) args[ len ] = arguments[ len ];\n\n    this$1.chain.push(\n      new Rule(name, ruleFn.apply(this$1, args), args, this$1.nextRuleModifiers)\n    );\n    this$1.nextRuleModifiers = [];\n    return this$1;\n  };\n};\n\nContext.prototype._applyModifier = function _applyModifier (modifier, name) {\n  this.nextRuleModifiers.push(\n    new Modifier(name, modifier.simple, modifier.async)\n  );\n  return this;\n};\n\nContext.prototype._clone = function _clone () {\n  return new Context(this.chain.slice(), this.nextRuleModifiers.slice());\n};\n\nContext.prototype.test = function test (value) {\n  return this.chain.every(function (rule) { return rule._test(value); });\n};\n\nContext.prototype.testAll = function testAll (value) {\n  var err = [];\n  this.chain.forEach(function (rule) {\n    try {\n      rule._check(value);\n    } catch (ex) {\n      err.push(new ValidationError(rule, value, ex));\n    }\n  });\n  return err;\n};\n\nContext.prototype.check = function check (value) {\n  this.chain.forEach(function (rule) {\n    try {\n      rule._check(value);\n    } catch (ex) {\n      throw new ValidationError(rule, value, ex);\n    }\n  });\n};\n\nContext.prototype.testAsync = function testAsync (value) {\n    var this$1 = this;\n\n  return new Promise(function (resolve, reject) {\n    executeAsyncRules(value, this$1.chain.slice(), resolve, reject);\n  });\n};\n\nfunction executeAsyncRules(value, rules, resolve, reject) {\n  if (rules.length) {\n    var rule = rules.shift();\n    rule._testAsync(value).then(\n      function () {\n        executeAsyncRules(value, rules, resolve, reject);\n      },\n      function (cause) {\n        reject(new ValidationError(rule, value, cause));\n      }\n    );\n  } else {\n    resolve(value);\n  }\n}\n\nvar consideredEmpty = function (value, considerTrimmedEmptyString) {\n  if (\n    considerTrimmedEmptyString &&\n    typeof value === 'string' &&\n    value.trim().length === 0\n  ) {\n    return true;\n  }\n\n  return value === undefined || value === null;\n};\n\nfunction optional (validation, considerTrimmedEmptyString) {\n  if ( considerTrimmedEmptyString === void 0 ) considerTrimmedEmptyString = false;\n\n  return ({\n  simple: function (value) { return consideredEmpty(value, considerTrimmedEmptyString) ||\n    validation.check(value) === undefined; },\n  async: function (value) { return consideredEmpty(value, considerTrimmedEmptyString) ||\n    validation.testAsync(value); },\n});\n}\n\nfunction v8n() {\n  return typeof Proxy !== 'undefined'\n    ? proxyContext(new Context())\n    : proxylessContext(new Context());\n}\n\n// Custom rules\nvar customRules = {};\n\nv8n.extend = function(newRules) {\n  Object.assign(customRules, newRules);\n};\n\nv8n.clearCustomRules = function() {\n  customRules = {};\n};\n\nfunction proxyContext(context) {\n  return new Proxy(context, {\n    get: function get(obj, prop) {\n      if (prop in obj) {\n        return obj[prop];\n      }\n\n      var newContext = proxyContext(context._clone());\n\n      if (prop in availableModifiers) {\n        return newContext._applyModifier(availableModifiers[prop], prop);\n      }\n      if (prop in customRules) {\n        return newContext._applyRule(customRules[prop], prop);\n      }\n      if (prop in availableRules) {\n        return newContext._applyRule(availableRules[prop], prop);\n      }\n    },\n  });\n}\n\nfunction proxylessContext(context) {\n  var addRuleSet = function (ruleSet, targetContext) {\n    Object.keys(ruleSet).forEach(function (prop) {\n      targetContext[prop] = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        var newContext = proxylessContext(targetContext._clone());\n        var contextWithRuleApplied = newContext._applyRule(\n          ruleSet[prop],\n          prop\n        ).apply(void 0, args);\n        return contextWithRuleApplied;\n      };\n    });\n    return targetContext;\n  };\n\n  var contextWithAvailableRules = addRuleSet(availableRules, context);\n  var contextWithAllRules = addRuleSet(\n    customRules,\n    contextWithAvailableRules\n  );\n\n  Object.keys(availableModifiers).forEach(function (prop) {\n    Object.defineProperty(contextWithAllRules, prop, {\n      get: function () {\n        var newContext = proxylessContext(contextWithAllRules._clone());\n        return newContext._applyModifier(availableModifiers[prop], prop);\n      },\n    });\n  });\n\n  return contextWithAllRules;\n}\n\nvar availableModifiers = {\n  not: {\n    simple: function (fn) { return function (value) { return !fn(value); }; },\n    async: function (fn) { return function (value) { return Promise.resolve(fn(value))\n        .then(function (result) { return !result; })\n        .catch(function () { return true; }); }; },\n  },\n\n  some: {\n    simple: function (fn) { return function (value) {\n      return split(value).some(function (item) {\n        try {\n          return fn(item);\n        } catch (ex) {\n          return false;\n        }\n      });\n    }; },\n    async: function (fn) { return function (value) {\n      return Promise.all(\n        split(value).map(function (item) {\n          try {\n            return fn(item).catch(function () { return false; });\n          } catch (ex) {\n            return false;\n          }\n        })\n      ).then(function (result) { return result.some(Boolean); });\n    }; },\n  },\n\n  every: {\n    simple: function (fn) { return function (value) { return value !== false && split(value).every(fn); }; },\n    async: function (fn) { return function (value) { return Promise.all(split(value).map(fn)).then(function (result) { return result.every(Boolean); }); }; },\n  },\n\n  strict: {\n    simple: function (fn, rule) { return function (value) {\n      if (isSchemaRule(rule) && value && typeof value === 'object') {\n        return (\n          Object.keys(rule.args[0]).length === Object.keys(value).length &&\n          fn(value)\n        );\n      }\n      return fn(value);\n    }; },\n    async: function (fn, rule) { return function (value) { return Promise.resolve(fn(value))\n        .then(function (result) {\n          if (isSchemaRule(rule) && value && typeof value === 'object') {\n            return (\n              Object.keys(rule.args[0]).length === Object.keys(value).length &&\n              result\n            );\n          }\n          return result;\n        })\n        .catch(function () { return false; }); }; },\n  },\n};\n\nfunction isSchemaRule(rule) {\n  return (\n    rule &&\n    rule.name === 'schema' &&\n    rule.args.length > 0 &&\n    typeof rule.args[0] === 'object'\n  );\n}\n\nfunction split(value) {\n  if (typeof value === 'string') {\n    return value.split('');\n  }\n  return value;\n}\n\nvar availableRules = {\n  // Value\n\n  equal: function (expected) { return function (value) { return value == expected; }; },\n\n  exact: function (expected) { return function (value) { return value === expected; }; },\n\n  // Types\n\n  number: function (allowInfinite) {\n    if ( allowInfinite === void 0 ) allowInfinite = true;\n\n    return function (value) { return typeof value === 'number' && (allowInfinite || isFinite(value)); };\n},\n\n  integer: function () { return function (value) {\n    var isInteger = Number.isInteger || isIntegerPolyfill;\n    return isInteger(value);\n  }; },\n\n  numeric: function () { return function (value) { return !isNaN(parseFloat(value)) && isFinite(value); }; },\n\n  string: function () { return testType('string'); },\n\n  boolean: function () { return testType('boolean'); },\n\n  undefined: function () { return testType('undefined'); },\n\n  null: function () { return testType('null'); },\n\n  array: function () { return testType('array'); },\n\n  object: function () { return testType('object'); },\n\n  instanceOf: function (instance) { return function (value) { return value instanceof instance; }; },\n\n  // Pattern\n\n  pattern: function (expected) { return function (value) { return expected.test(value); }; },\n\n  lowercase: function () { return function (value) {\n    return (\n      typeof value === 'boolean' ||\n      (value === value.toLowerCase() && value.trim() !== '')\n    );\n  }; },\n\n  uppercase: function () { return function (value) { return value === value.toUpperCase() && value.trim() !== ''; }; },\n\n  vowel: function () { return function (value) { return /^[aeiou]+$/i.test(value); }; },\n\n  consonant: function () { return function (value) { return /^(?=[^aeiou])([a-z]+)$/i.test(value); }; },\n\n  // Value at\n\n  first: function (expected) { return function (value) { return value[0] == expected; }; },\n\n  last: function (expected) { return function (value) { return value[value.length - 1] == expected; }; },\n\n  // Length\n\n  empty: function () { return function (value) { return value.length === 0; }; },\n\n  length: function (min, max) { return function (value) { return value.length >= min && value.length <= (max || min); }; },\n\n  minLength: function (min) { return function (value) { return value.length >= min; }; },\n\n  maxLength: function (max) { return function (value) { return value.length <= max; }; },\n\n  // Range\n\n  negative: function () { return function (value) { return value < 0; }; },\n\n  positive: function () { return function (value) { return value >= 0; }; },\n\n  between: function (a, b) { return function (value) { return value >= a && value <= b; }; },\n\n  range: function (a, b) { return function (value) { return value >= a && value <= b; }; },\n\n  lessThan: function (n) { return function (value) { return value < n; }; },\n\n  lessThanOrEqual: function (n) { return function (value) { return value <= n; }; },\n\n  greaterThan: function (n) { return function (value) { return value > n; }; },\n\n  greaterThanOrEqual: function (n) { return function (value) { return value >= n; }; },\n\n  // Divisible\n\n  even: function () { return function (value) { return value % 2 === 0; }; },\n\n  odd: function () { return function (value) { return value % 2 !== 0; }; },\n\n  includes: function (expected) { return function (value) { return ~value.indexOf(expected); }; },\n\n  schema: function (schema) { return testSchema(schema); },\n\n  // branching\n\n  passesAnyOf: function () {\n    var validations = [], len = arguments.length;\n    while ( len-- ) validations[ len ] = arguments[ len ];\n\n    return function (value) { return validations.some(function (validation) { return validation.test(value); }); };\n},\n\n  optional: optional,\n};\n\nfunction testType(expected) {\n  return function (value) {\n    return (\n      (Array.isArray(value) && expected === 'array') ||\n      (value === null && expected === 'null') ||\n      typeof value === expected\n    );\n  };\n}\n\nfunction isIntegerPolyfill(value) {\n  return (\n    typeof value === 'number' && isFinite(value) && Math.floor(value) === value\n  );\n}\n\nfunction testSchema(schema) {\n  return {\n    simple: function (value) {\n      var causes = [];\n      Object.keys(schema).forEach(function (key) {\n        var nestedValidation = schema[key];\n        try {\n          nestedValidation.check((value || {})[key]);\n        } catch (ex) {\n          ex.target = key;\n          causes.push(ex);\n        }\n      });\n      if (causes.length > 0) {\n        throw causes;\n      }\n      return true;\n    },\n    async: function (value) {\n      var causes = [];\n      var nested = Object.keys(schema).map(function (key) {\n        var nestedValidation = schema[key];\n        return nestedValidation.testAsync((value || {})[key]).catch(function (ex) {\n          ex.target = key;\n          causes.push(ex);\n        });\n      });\n      return Promise.all(nested).then(function () {\n        if (causes.length > 0) {\n          throw causes;\n        }\n\n        return true;\n      });\n    },\n  };\n}\n\nexport default v8n;\n"]},"metadata":{},"sourceType":"module"}